# COMPREHENSIVE FIX SCRIPTWrite-Host "`n=============================================" -ForegroundColor CyanWrite-Host "   NATPUDAN AI - COMPREHENSIVE FIX SCRIPT  " -ForegroundColor Cyan  Write-Host "=============================================`n" -ForegroundColor CyanWrite-Host "Step 1: Checking server status..." -ForegroundColor Yellow$backend = Test-NetConnection -ComputerName 127.0.0.1 -Port 8001 -InformationLevel Quiet -WarningAction SilentlyContinue$frontend = Test-NetConnection -ComputerName 127.0.0.1 -Port 5173 -InformationLevel Quiet -WarningAction SilentlyContinueif ($backend) {    Write-Host "  [OK] Backend is running" -ForegroundColor Green} else {    Write-Host "  [X] Backend NOT running - Starting..." -ForegroundColor Yellow    Start-Process powershell -ArgumentList "-NoExit", "-Command", "cd D:\Users\CNSHO\Documents\GitHub\Natpudan-\backend; python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8001"    Start-Sleep -Seconds 5}if ($frontend) {    Write-Host "  [OK] Frontend is running" -ForegroundColor Green} else {    Write-Host "  [X] Frontend NOT running - Starting..." -ForegroundColor Yellow    Start-Process powershell -ArgumentList "-NoExit", "-Command", "cd D:\Users\CNSHO\Documents\GitHub\Natpudan-\frontend; npm run dev"    Start-Sleep -Seconds 5}Write-Host "`nStep 2: Testing backend API..." -ForegroundColor Yellowtry {    $response = Invoke-RestMethod -Uri "http://127.0.0.1:8001/health"    Write-Host "  [OK] Backend health check passed" -ForegroundColor Green} catch {    Write-Host "  [X] Backend failed: $($_.Exception.Message)" -ForegroundColor Red}Write-Host "`nStep 3: Testing login..." -ForegroundColor Yellowtry {    $loginBody = '{"email":"doctor@example.com","password":"doctor123"}'    $loginResponse = Invoke-RestMethod -Uri "http://127.0.0.1:8001/api/auth/login" -Method Post -Body $loginBody -ContentType "application/json"    Write-Host "  [OK] Login working - User: $($loginResponse.user.full_name)" -ForegroundColor Green} catch {    Write-Host "  [X] Login failed" -ForegroundColor Red    if ($_.Exception.Message -like "*401*") {        Write-Host "  -> Creating users..." -ForegroundColor Yellow        Push-Location D:\Users\CNSHO\Documents\GitHub\Natpudan-\backend        python -c "from app.database import SessionLocal; from app.crud import create_user; from app.models import User; db = SessionLocal(); existing = [u.email for u in db.query(User).all()]; users = [('doctor@example.com', 'doctor123', 'Dr. John Smith', 'doctor'), ('admin@example.com', 'admin123', 'Admin User', 'admin')]; [create_user(db, email=u[0], password=u[1], full_name=u[2], role=u[3]) for u in users if u[0] not in existing]; db.commit(); db.close()"        Pop-Location        Write-Host "  [OK] Users created" -ForegroundColor Green    }}Write-Host "`nStep 4: Testing OAuth..." -ForegroundColor Yellowtry {    $oauth = Invoke-RestMethod -Uri "http://127.0.0.1:8001/api/auth/oauth/google/url?redirect_uri=http://localhost:5173/auth/callback"    Write-Host "  [OK] OAuth working" -ForegroundColor Green} catch {    Write-Host "  [X] OAuth failed" -ForegroundColor Red}Write-Host "`n=============================================" -ForegroundColor GreenWrite-Host "           ALL TESTS COMPLETE!              " -ForegroundColor GreenWrite-Host "=============================================`n" -ForegroundColor GreenWrite-Host "LOGIN AT: http://localhost:5173/login" -ForegroundColor CyanWrite-Host "Email: doctor@example.com" -ForegroundColor WhiteWrite-Host "Password: doctor123" -ForegroundColor WhiteWrite-Host "`n[!] CLEAR BROWSER CACHE: Ctrl+Shift+R" -ForegroundColor RedWrite-Host "`nPress any key to open diagnostic tool..." -ForegroundColor Gray$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")Start-Process "D:\Users\CNSHO\Documents\GitHub\Natpudan-\TEST_API.html"